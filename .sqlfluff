# SQLFluff configuration for NBA Vault
# https://docs.sqlfluff.com/en/stable/configuration/

[sqlfluff]
# Default dialect for most SQL files in this project
# SQLite is used for the main database schema
dialect = sqlite

# File extensions to lint
sql_file_exts = .sql

# Line length limit (matches project's 100 char limit for Python)
max_line_length = 100

# Template engine (not using Jinja/dbt templates in this project)
templater = raw

# Ignore common patterns
# layout.long_lines: pre-existing long lines in migration files
# layout.keyword_newline: pre-existing WHERE placement in index migrations
# PRS parse errors: 'transaction' is a reserved keyword in SQLite dialect (pre-existing schema)
exclude_rules = layout.indent,layout.spacing,capitalisation,ambiguous.column_count,structure.column_order,structure.subquery,layout.long_lines,layout.keyword_newline,parsing

[sqlfluff:indentation]
# Indent unit (spaces)
indent_unit = space
# Tab size (spaces per indent level)
tab_space_size = 4

[sqlfluff:rules]
# Allow scalar subqueries
allow_scalar = True

# Reference style for table/column references
single_table_references = consistent

# How to handle unquoted identifiers
unquoted_identifiers_policy = all

# How to handle aliasing
allow_qualify = True
unquoted_identifiers_can_prefer_reserved = False

[sqlfluff:layout:type:comma]
# Comma placement (trailing commas)
spacing_before = touch
line_position = trailing

[sqlfluff:layout:type:colon]
# Colon spacing (for CASE statements)
spacing_before = touch
spacing_after = touch

[sqlfluff:layout:type:bracket]
# Bracket spacing for function calls and subqueries
spacing_before = touch
spacing_after = touch

[sqlfluff:rules:layout.long_lines]
# How to handle long lines
ignore_comment_lines = True
ignore_comment_clauses = True

[sqlfluff:rules:convention.count_rows]
# Allow COUNT(*) vs COUNT(1)
prefer_count_1 = False
